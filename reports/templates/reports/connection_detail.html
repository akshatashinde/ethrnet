{% extends "admin_base.html" %}

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    
    <!-- <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.3.0/css/datepicker.min.css" type="text/css" />
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" type="text/css" />
     -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
<link rel="stylesheet" href="/reports/dropdown.css">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/css/bootstrap-datetimepicker.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.min.js"></script>   

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/js/bootstrap-datetimepicker.min.js"></script>     
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
 
<!--<script type="text/javascript"> 
//     var jQuery_1_12_2 = $.noConflict(true); 
// </script>-->

{% block content %}

        
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
// <script>
//   $(document).ready(function(){
//     $("#row_month").hide();
//     $("#id_month").click(function(){
      
//       $("#row_month").show();
//     });  
//   });  
// </script>



<script type="text/javascript">
  $(document).on('submit','#custom_report',function(e){
    e.preventDefault();
    var clientpk = [];

    {% for client in clients %}
        clientpk.push('{{ client.pk }}');
    {% endfor %}

    alert(clientpk);
    $.ajax({
      type:'POST',
      url:'/reports/connection_detail/1/',
      data:{
        start_date:$('#start_date').val(),
        last_date:$('#last_date').val(),
        action : 'start1',
        csrfmiddlewaretoken:'{{ csrf_token }}'

      },
      success:function(data){
        alert("custom report created!");
        console.log(data);
        $tbody = $('#custom_table').find('tbody');
            for(i=0;i<data.length;i++)
            {
              $row = $('<tr>');
              // $.each(data[i].fields, function(key, value){
              //   $col = $('<td>');
              //   $col.text(key+':'+value);
              //   $row.append($col);
              // });  
              $col1 = $('<td>');
              $col1.text(data[i].fields.client);
              $row.append($col1);
              $col2 = $('<td>');
              $col2.text(data[i].fields.plan);
              $row.append($col2);
              $col3 = $('<td>');
              if (data[i].fields.is_active == true)
              {
                $col3.text('active');
              }
              else
              {
                $col3.text('Non-active');
              }
              // $col3.text(data[i].fields.is_active);
              $row.append($col3);
              $col4 = $('<td>');
              $col4.text(data[i].fields.created_on);
              $row.append($col4);
              $col5 = $('<td>');
              $col5.text(data[i].fields.expired_on);
              $row.append($col5);
              console.log($row);
                
                
                
              // }); 

              $tbody.append($row);
            }  
      }
    });
  });

</script>

<script type="text/javascript">
  $(document).on('submit','#year_report',function(e){
    e.preventDefault();
    var clientpk = [];

    {% for client in clients %}
        clientpk.push('{{ client.pk }}');
    {% endfor %}

    alert(clientpk);
    $.ajax({
      type:'POST',
      url:'/reports/connection_detail/1/',
      data:{
        currentdate:$('#currentdate').val(),
        action : 'start2',
        csrfmiddlewaretoken:'{{ csrf_token }}'
      },
      success:function(data){
        alert("year report created!");
        console.log(data);
        $tbody = $('#year_table').find('tbody');
            for(i=0;i<data.length;i++)
            {
              $row = $('<tr>');  
              $col1 = $('<td>');
              $col1.text(data[i].fields.client);
              $row.append($col1);
              $col2 = $('<td>');
              $col2.text(data[i].fields.plan);
              $row.append($col2);
              $col3 = $('<td>');
              if (data[i].fields.is_active == true)
              {
                $col3.text('active');
              }
              else
              {
                $col3.text('Non-active');
              }
              $row.append($col3);
              $col4 = $('<td>');
              $col4.text(data[i].fields.created_on);
              $row.append($col4);
              $col5 = $('<td>');
              $col5.text(data[i].fields.expired_on);
              $row.append($col5);
              console.log($row);

              $tbody.append($row);
            }  
      }
    });
  });
</script>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script type="text/javascript">
  
  $("#id_month").live("click", function () { 
        console.log($(this).attr('name'));
        var id = $(this).attr('value');
        $('#id_month[value!='+id+']').remove();
          event.preventDefault(); 
          $.ajax({
            type:'POST',
            url:'/reports/connection_detail/1/',
            data:{
            idfname: $(this).attr('value'),
            action : 'start3',
            csrfmiddlewaretoken: '{{ csrf_token }}'
            },
            success: function(data) {
              alert("month report created!");
              console.log(data);
              $tbody = $('#month_table').find('tbody');
              for(i=0;i<data.length;i++)
              {
                $row = $('<tr>');
                $col1 = $('<td>');
                $col1.text(data[i].fields.client);
                $row.append($col1);
                $col2 = $('<td>');
                $col2.text(data[i].fields.plan);
                $row.append($col2);
                $col3 = $('<td>');
                if (data[i].fields.is_active == true)
                {
                  $col3.text('active');
                }
                else
                {
                  $col3.text('Non-active');
                }
                $row.append($col3);
                $col4 = $('<td>');
                $col4.text(data[i].fields.created_on);
                $row.append($col4);
                $col5 = $('<td>');
                $col5.text(data[i].fields.expired_on);
                $row.append($col5);
                console.log($row);

                $tbody.append($row);
              }  
            }
          });  
        
        
          
       
  });
</script>
<section class="content">
    <div class="row" id="cc">
        <div class="col-xs-12">
            <div class="box box-info">
                <div class="box-header">
                    <h3 class="box-title"><b>current Connection </b></h3>
                </div><!-- /.box-header -->
                <form action="" method="post" >
                    <div class="box-body table-responsive no-padding">
                        <table class="table table-hover" id="client_table">
                            <tbody>
                            <tr>
                                <th>ID</th>
                                <th>Client Id</th>
                                <th>Plan</th>
                                <th>Status</th>
                                <th>Creation Date</th>
                                <th>Expired Date</th>
                            </tr>
                            {% for current in conn %}
                            <tr>
                                <td>{{ current.id }}</td>
                                <td>{{ current.client }}</td>
                                <td>{{ current.plan }}</td>
                                <td>
                                    {% if current.is_active %}
                                        <span class="label label-primary">Active</span>
                                    {% else %}
                                        <span class="label label-danger">Deactive</span>
                                    {% endif %}
                                </td>
                                
                                <td>{{ current.created_on }}</td>
                                <td>{{ current.expired_on }}</td>
                                
                                
                            </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                            
                </form>
            </div>
        </div>
    </div>
</section>
<section class="content">
    <div class="row">
        <div class="col-xs-12">
            <div class="box box-info">
                <div class="box-header">
                    

                            <div class="col-xs-9"><h3 class="box-title"><b><strong>Connection History</strong></b></h3></div>
                           
                        
                </div>    
                <div class="container">
                    <ul class="nav nav-tabs">
                        <li><a data-toggle="tab" href="#home" id="id_all" value="#home">All</a></li>
                        <li><a data-toggle="tab" href="#menu1" id="id_last_month" value="#menu1">Last_Month</a></li>
                        <li><a data-toggle="tab" href="#menu2" id="id_custom" value="#menu2">Custom</a></li>
                        <li><a data-toggle="tab" href="#year" id="id_year" value="#year">Year_wise</a></li>
                        <li class="dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#menu5">Month_wise <span class="caret"></span></a>
                            <ul name="type" id="type" class="dropdown-menu scrollable-menu" style="width: 100px;height: 200px;overflow: scroll;">
                                <li value="jan"><a  id="id_month" name="jan" value="01">January</a></li>
                                <li value="feb"><a  id="id_month" name="feb" value="02">February</a></li>
                                <li value="march"><a  id="id_month" name="march" value="03" >March</a></li>
                                <li value="april"><a  id="id_month" name="April" value="04">April</a></li>
                                <li value="may"><a  id="id_month" name="may" value="05" >May</a></li>
                                <li value="june"><a  id="id_month" name="june" value="06">June</a></li>
                                <li value="jully"><a  id="id_month" name="jully" value="07">jully</a></li>
                                <li value="august"><a  id="id_month" name="august" value="08">August</a></li>
                                <li value="september"><a  id="id_month" name="september" value="09">September</a></li>
                                <li value="octomber"><a  id="id_month" name="octomber" value="10">Octomber</a></li>
                                <li value="november"><a  id="id_month" name="november" value="11">November</a></li>
                                <li value="november"><a  id="id_month" name="december" value="12">December</a></li>                        
                            </ul>
                        </li>
                    </ul>
                </div>

                <div id="row_month">
                          
                    <div class="box-body table-responsive no-padding">
                      <table class="table table-hover" id="month_table">
                        <tbody>
                        <tr>
                            <th>Client Id</th>
                            <th>Plan</th>
                            <th>Status</th>
                            <th>Created on</th>
                            <th>Expired on</th>
                            <th></th>
                        </tr>
            
                        </tbody>
                      </table>
                    </div>   
                </div>
                
                

                <div class="tab-content" id ="maintab">
                    <div id="home" class="tab-pane fade in active">
                        
                        
                        <div class="box-body table-responsive no-padding">
                                        <table class="table table-hover" id="client_table">
                                            <tbody>
                                            <tr>
                                                <th>ID</th>
                                                <th>Client Id</th>
                                                <th>Plan</th>
                                                <th>Status</th>
                                                <th>Created On</th>
                                                <th>Expired on</th>
                                                <th></th>
                                            </tr>
                                            {% for connection in all_list %}
                                            <tr>
                                                <td>{{ connection.id }}</td>
                                                <td>{{ connection.client }}</td>
                                                <td>{{ connection.plan }}</td>
                                                <td>
                                                    {% if connection.is_active %}
                                                        <span class="label label-primary">Active</span>
                                                    {% else %}
                                                        <span class="label label-danger">Deactive</span>
                                                    {% endif %}
                                                </td>
                                                <td>{{ connection.created_on }}</td>
                                                <td>{{ connection.expired_on }}</td>
                                                <td>
                                                    <button class="btn btn-default btn-sm"><i class="fa fa-trash-o"></i></button>
                                                    <button class="btn btn-default btn-sm"><i class="fa fa-edit"></i></button>
                                                </td>
                                            </tr>
                                            {% endfor %}
                                            </tbody>
                                        </table>
                        </div>    
                    
                    </div>
                    <div id="menu1" class="tab-pane fade">
                            
                        <div class="box-body table-responsive no-padding">
                            <input id="id_ex" type="text" name="ex" value="lastmonth">
                                        <table class="table table-hover" id="client_table">
                                            <tbody>
                                            <tr>
                                                <th>ID</th>
                                                <th>Client Id</th>
                                                <th>Plan</th>
                                                <th>Status</th>
                                                <th>Created on</th>
                                                <th>Expired on</th>
                                                <th></th>
                                            </tr>
                                            {% for connection in last_month %}
                                            <tr>
                                                <td>{{ connection.id }}</td>
                                                <td>{{ connection.client }}</td>
                                                <td>{{ connection.plan }}</td>
                                                <td>
                                                    {% if connection.is_active %}
                                                        <span class="label label-primary">Active</span>
                                                    {% else %}
                                                        <span class="label label-danger">Deactive</span>
                                                    {% endif %}
                                                </td>
                                                <td>{{ connection.created_on }}</td>
                                                <td>{{ connection.expired_on }}</td>
                                                <td>
                                                    <button class="btn btn-default btn-sm"><i class="fa fa-trash-o"></i></button>
                                                        <button class="btn btn-default btn-sm"><i class="fa fa-edit"></i></button>
                                                </td>
                                            </tr>
                                            {% endfor %}
                                            </tbody>
                                        </table>
                        </div>    
                    </div>
                    <div id="menu2" class="tab-pane fade">
                        <h4>Enter Date for Searching records</h4>
                        
                        <form id ="custom_report">{% csrf_token %}
                            </br>
                            <div class="row">
                                <div class="col-xs-2">
                                    <input id="start_date" type="date" name="start_date" placeholder="Enter Start Date">
                                </div>   
                                <div class="col-xs-2">
                                    <input id= "last_date" type="date" name="last_date" placeholder="Enter Start Date">
                                </div>   
                                <div class="col-xs-1">
                                    <input type="submit" value="Submit" class="btn btn-primary">
                                </div>    
                            </div>
                            </br>
                                <div class="box-body table-responsive no-padding">
                                        <table class="table table-hover" id="custom_table">
                                          <tbody>
                                          <tr>
                                                <th>Client Id</th>
                                                <th>Plan</th>
                                                <th>Status</th>
                                                <th>Created On</th>
                                                <th>Expired on</th>
                                                <th></th>
                                                
                                                
                                                <th></th>
                                            </tr>
                                          </tbody> 
                                        </table>
                                </div>
                                   
                        </form>   
                    </div>
                    <div id="year" class="tab-pane fade">
                        <h4>Enter Date for Searching records</h4>
                        <form id ="year_report">{% csrf_token %}
                           
                          <div class="container">
                            <div class="col-sm-6" style="height:75px;">
                                <div class='col-md-5'>
                                    <div class="form-group">
                                      <div class='input-group date' id='currentDate'>
                                        <input type='text' class="form-control" name="currentdate" id="currentdate" />
                                        <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span>
                                        </span>
                                      </div>
                                    </div>
                                </div>
                                <div class="col-xs-3">
                                  <input type="submit" value="Submit" class="btn btn-primary">
                                </div>
                            </div>
                          </div>
                          <div class="box-body table-responsive no-padding">
                            <table class="table table-hover" id="year_table">
                              <tbody>
                                <tr>
                                  <th>Client Id</th>
                                  <th>Plan</th>
                                  <th>Status</th>
                                  <th>Created On</th>
                                  <th>Expired on</th>
                                  <th></th>
                                  <th></th>
                                </tr>    
                              </tbody>
                            </table>
                          </div>
                          <script type="text/javascript">
                              jQuery(function () {
                                  jQuery('#currentDate').datepicker({
                                      format :'yyyy'
                                  });
                              });
                          </script>
                        </from>
                    </div>
                        
                        
                    
                    
                </div>
            </div>    
        </div>
    </div>
 
</section>

{% endblock content %}
